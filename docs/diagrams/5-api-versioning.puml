@startuml API Versioning
!theme plain
skinparam packageStyle rectangle

package "Client Requests" as clients {
  [Mobile App v1] as mobile1
  [Web App v1] as web1
  [Mobile App v2] as mobile2
}

package "API Layer" as api {
  package "API v1" #E8F5E9 {
    [V1 Controllers] as v1ctrl
    [V1 DTOs] as v1dto
    [V1 Transformers] as v1trans
  }

  package "API v2" #E3F2FD {
    [V2 Controllers] as v2ctrl
    [V2 DTOs] as v2dto
    [V2 Transformers] as v2trans
  }
}

package "Domain Layer\n(Shared)" #FFF9C4 {
  [Lead Service] as leadService
  [Contact Service] as contactService
  [Lead Entity] as leadEntity
  [Contact Entity] as contactEntity
}

mobile1 --> v1ctrl : /api/v1/leads
web1 --> v1ctrl : /api/v1/leads
mobile2 --> v2ctrl : /api/v2/leads

v1ctrl --> leadService
v2ctrl --> leadService

v1ctrl --> v1trans
v2ctrl --> v2trans

v1trans --> v1dto : produces
v2trans --> v2dto : produces

leadService --> leadEntity
leadService --> contactService
contactService --> contactEntity

note right of v1dto
  V1 Response:
  {
    "id": 123,
    "title": "...",
    "created_at": "2025-01-15 10:30:00"
  }
end note

note right of v2dto
  V2 Response (different structure):
  {
    "uuid": "550e8400...",
    "title": "...",
    "created_at": {
      "date": "2025-01-15",
      "time": "10:30:00"
    },
    "metadata": {...}
  }
end note

note bottom of leadEntity
  Domain layer remains unchanged.
  Only presentation (API) differs
  between versions.
end note

@enduml